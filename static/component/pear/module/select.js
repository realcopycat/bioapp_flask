/** pear-admin-v3.10.0 MIT License By http://www.pearadmin.com/ */
 ;"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=n():"function"==typeof define&&define.amd?define(n):t.layui&&e.define?e.define(["jquery"],(function(e){e("select",n())})):t.formSelects=n()}("undefined"==typeof layui?null:layui,window,(function(){var e="xm-select",t="xm-select-parent",n="xm-select-input",i="xm-select--suffix",a="xm-select-this",r="xm-select-label",o="xm-select-search",l="xm-select-search-type",s="xm-select-skin",c="xm-dis-disabled",d="xm-select-dis",f="xm-select-temp",u="xm-select-radio",p="xm-select-linkage",h="xm-select-dl",v="xm-select-hide",m="xm-hide-input",y="xm-select-sj",g="xm-select-title",x="xm-form-select",k="xm-form-selected",b="xm-select-none",C="xm-select-empty",w="xm-select-tips",S="xm-cz",T="xm-cz-group",L="请选择",A={},j={on:{},endOn:{},filter:{},maxTips:{},opened:{},closed:{}},E={type:"get",header:{},first:!0,data:{},searchUrl:"",searchName:"keyword",searchVal:null,keyName:"name",keyVal:"value",keySel:"selected",keyDis:"disabled",keyChildren:"children",dataType:"",delay:500,beforeSuccess:null,success:null,error:null,beforeSearch:null,response:{statusCode:0,statusName:"code",msgName:"msg",dataName:"data"},tree:{nextClick:function(e,t,n){n([])},folderChoose:!0,lazy:!0}},D=[{icon:"xm-iconfont icon-quanxuan",name:"全选",click:function(e,t){t.selectAll(e,!0,!0)}},{icon:"xm-iconfont icon-qingkong",name:"清空",click:function(e,t){t.removeAll(e,!0,!0)}},{icon:"xm-iconfont icon-fanxuan",name:"反选",click:function(e,t){t.reverse(e,!0,!0)}},{icon:"xm-iconfont icon-pifu",name:"换肤",click:function(e,t){t.skin(e)}}],N=window.$||window.layui&&window.layui.jquery,H=N(window),_={},F={},O={},I=function(t){var n=this;this.config={name:null,max:null,maxTips:function(t,i,a,r){var o=N('[xid="'+n.config.name+'"]').prev().find("."+e);o.parents(".layui-form-item[pane]").length&&(o=o.parents(".layui-form-item[pane]")),o.attr("style","border-color: red !important"),setTimeout((function(){o.removeAttr("style")}),300)},init:null,on:null,opened:null,closed:null,filter:function(e,t,n,i){return-1==n.name.indexOf(t)},clearid:-1,direction:"auto",height:null,isEmpty:!1,btns:[D[0],D[1],D[2]],searchType:0,create:function(e,t){return Date.now()},template:function(e,t){return t.name},showCount:0,isCreate:!1,placeholder:L,clearInput:!1},this.select=null,this.values=[],N.extend(this.config,t,{searchUrl:t.isSearch?t.searchUrl:null,placeholder:t.optionsFirst?t.optionsFirst.value?L:t.optionsFirst.innerHTML||L:L,btns:t.radio?[D[1]]:[D[0],D[1],D[2]]},O[t.name]||F),(isNaN(this.config.showCount)||this.config.showCount<=0)&&(this.config.showCount=19921012)},P=function(){this.appender(),this.on(),this.onreset()};P.prototype.appender=function(){Array.prototype.map||(Array.prototype.map=function(e,t){var n,i,a,r=Object(this),o=r.length>>>0;for(t&&(n=t),i=new Array(o),a=0;a<o;){var l,s;a in r&&(l=r[a],s=e.call(n,l,a,r),i[a]=s),a++}return i}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,i;if(null==this)throw new TypeError("this is null or not defined");var a=Object(this),r=a.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),i=0;i<r;){var o;i in a&&(o=a[i],e.call(n,o,i,a)),i++}}),Array.prototype.filter||(Array.prototype.filter=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var i=[],a=arguments[1],r=0;r<n;r++)if(r in t){var o=t[r];e.call(a,o,r,t)&&i.push(o)}return i})},P.prototype.init=function(a){var c=this;N(a||"select["+e+"]").each((function(a,f){var p=N(f),v=p.attr(e),x=p.next(".layui-form-select"),k=p.next("."+t),b={name:v,disabled:f.disabled,max:p.attr("xm-select-max")-0,isSearch:null!=p.attr(o),searchUrl:p.attr(o),isCreate:null!=p.attr("xm-select-create"),radio:null!=p.attr(u),skin:p.attr(s),direction:p.attr("xm-select-direction"),optionsFirst:f.options[0],height:p.attr("xm-select-height"),formname:p.attr("name")||p.attr("_name"),layverify:p.attr("lay-verify")||p.attr("_lay-verify"),layverType:p.attr("lay-verType"),searchType:"dl"==p.attr(l)?1:0,showCount:p.attr("xm-select-show-count")-0},C=p.find("option[selected]").toArray().map((function(e){return{name:e.innerHTML,value:e.value}})),w=new I(b);w.values=C,w.config.init?(w.values=w.config.init.map((function(e){return"object"==(void 0===e?"undefined":_typeof(e))?e:{name:p.find('option[value="'+e+'"]').text(),value:e}})).filter((function(e){return e.name})),w.config.init=w.values.concat([])):w.config.init=C.concat([]),!w.values&&(w.values=[]),A[v]=w,x[0]&&x.remove(),k[0]&&k.remove();var S=c.renderSelect(v,w.config.placeholder,f),T=w.config.height&&"auto"!=w.config.height?'xm-hg style="height: 34px;"':"",L=['<div class="'+r+'">','<input type="text" fsw class="xm-input '+n+'" '+(w.config.isSearch?"":'style="display: none;"')+' autocomplete="off" debounce="0" />',"</div>"],j=N('<div class="xm-form-select" '+s+'="'+w.config.skin+'">\n\t\t\t\t\t<input class="'+m+'" value="" name="'+w.config.formname+'" lay-verify="'+w.config.layverify+'" lay-verType="'+w.config.layverType+'" type="text" style="position: absolute;bottom: 0; z-index: -1;width: 100%; height: 100%; border: none; opacity: 0;"/>\n\t\t\t\t\t<div class="'+g+" "+(w.config.disabled?d:"")+'">\n\t\t\t\t\t\t<div class="'+"xm-input "+e+'" '+T+">\n\t\t\t\t\t\t\t"+L.join("")+'\n\t\t\t\t\t\t\t<i class="'+y+'"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="'+i+'">\n\t\t\t\t\t\t\t<input type="text" autocomplete="off" placeholder="'+w.config.placeholder+'" readonly="readonly" unselectable="on" class="'+'xm-input">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<dl xid="'+v+'" class="'+h+" "+(w.config.radio?u:"")+'">'+S+"</dl>\n\t\t\t\t</div>"),D=N('<div class="'+t+'" FS_ID="'+v+'"></div>');D.append(j),p.after(D),p.attr("lay-ignore",""),p.removeAttr("name")&&p.attr("_name",w.config.formname),p.removeAttr("lay-verify")&&p.attr("_lay-verify",w.config.layverify),w.config.isSearch?(_[v]=N.extend({},E,{searchUrl:w.config.searchUrl},_[v]),N(document).on("input","div."+t+'[FS_ID="'+v+'"] .'+n,(function(e){c.search(v,e,w.config.searchUrl)})),w.config.searchUrl&&c.triggerSearch(j,!0)):j.find("dl dd.xm-dl-input").css("display","none")}))},P.prototype.search=function(e,t,n,i){var a=this,r=void 0;if(i)r=i;else{r=t.target;var o=t.keyCode;if(9===o||13===o||37===o||38===o||39===o||40===o)return!1}var l=N.trim(r.value);this.changePlaceHolder(N(r));var s=_[e]?_[e]:E;n=s.searchUrl||n;var d=A[e],f=d.config.isCreate,u=N('dl[xid="'+e+'"]').parents("."+x);if(n){if(s.searchVal&&(l=s.searchVal,s.searchVal=""),!s.beforeSearch||s.beforeSearch&&s.beforeSearch instanceof Function&&s.beforeSearch(e,n,l)){var p=s.delay;s.first&&(s.first=!1,p=10),clearTimeout(d.clearid),d.clearid=setTimeout((function(){u.find("dl > *:not(.xm-select-tips)").remove(),u.find("dd."+b).addClass(C).text("请求中"),a.ajax(e,n,l,!1,null,!0)}),p)}}else u.find("dl ."+v).removeClass(v),u.find("dl dd:not(.xm-select-tips)").each((function(t,n){var i=N(n),r=j.filter[e]||A[e].config.filter;r&&1==r(e,l,a.getItem(e,i),i.hasClass(c))&&i.addClass(v)})),u.find("dl dt").each((function(e,t){N(t).nextUntil("dt",":not(."+v+")").length||N(t).addClass(v)})),this.create(e,f,l),u.find("dl dd:not(.xm-select-tips):not(."+v+")").length?u.find("dd."+b).removeClass(C):u.find("dd."+b).addClass(C).text("无匹配项")},P.prototype.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)},P.prototype.triggerSearch=function(e,t){var i=this;(e?[e]:N("."+x).toArray()).forEach((function(e,a){var o=(e=N(e)).find("dl").attr("xid");(o&&A[o]&&A[o].config.isEmpty||t)&&i.search(o,null,null,0==A[o].config.searchType?e.find("."+r+" ."+n):e.find("dl .xm-dl-input ."+n))}))},P.prototype.clearInput=function(e){var i=N("."+t+'[fs_id="'+e+'"]');(0==A[e].config.searchType?i.find("."+r+" ."+n):i.find("dl .xm-dl-input ."+n)).val("")},P.prototype.ajax=function(e,n,i,a,r,o,l,s){var c=this,d=N("."+t+' dl[xid="'+e+'"]').parents("."+x);if(d[0]&&n){var f=_[e]?_[e]:E,u=N.extend(!0,{},f.data);u[f.searchName]=i,N.ajax({type:f.type,headers:f.header,url:n,data:"json"==f.dataType?JSON.stringify(u):u,success:function(t){if("string"==typeof t&&(t=JSON.parse(t)),f.beforeSuccess&&f.beforeSuccess instanceof Function&&(t=f.beforeSuccess(e,n,i,t)),c.isArray(t)){var u={};u[f.response.statusName]=f.response.statusCode,u[f.response.msgName]="",u[f.response.dataName]=t,t=u}t[f.response.statusName]!=f.response.statusCode?d.find("dd."+b).addClass(C).text(t[f.response.msgName]):(d.find("dd."+b).removeClass(C),c.renderData(e,t[f.response.dataName],a,r,o,s),A[e].config.isEmpty=0==t[f.response.dataName].length),l&&l(e),f.success&&f.success instanceof Function&&f.success(e,n,i,t)},error:function(t){d.find("dd[lay-value]:not(.xm-select-tips)").remove(),d.find("dd."+b).addClass(C).text("服务异常"),f.error&&f.error instanceof Function&&f.error(e,n,i,t)}})}},P.prototype.renderData=function(e,n,o,l,s,c){var d=this;if(o)this.renderLinkage(e,n,l);else if(c)this.renderReplace(e,n);else{var f=N("."+t+' dl[xid="'+e+'"]').parents("."+x),u=_[e]?_[e]:E,p=f.find("."+i+" input");n=this.exchangeData(e,n);var h=[];f.find("dl").html(this.renderSelect(e,p.attr("placeholder")||p.attr("back"),n.map((function(e){var t=N.extend({},e,{innerHTML:e[u.keyName],value:e[u.keyVal],sel:e[u.keySel],disabled:e[u.keyDis],type:e.type,name:e[u.keyName]});return t.sel&&h.push(t),t}))));var v=f.find("."+r),m=f.find("dl[xid]");if(s){var y=A[e].values;y.forEach((function(e,t){m.find('dd[lay-value="'+e.value+'"]').addClass(a)})),h.forEach((function(t,n){-1==d.indexOf(y,t)&&(d.addLabel(e,v,t),m.find('dd[lay-value="'+t.value+'"]').addClass(a),y.push(t))}))}else h.forEach((function(t,n){d.addLabel(e,v,t),m.find('dd[lay-value="'+t.value+'"]').addClass(a)})),A[e].values=h;this.commonHandler(e,v)}},P.prototype.renderLinkage=function(e,i,a){var r=[],o=0,l={0:i},s=_[e]?_[e]:E;V[e]={};var c=function(){var t=r[o++]=[],n=l;l={},N.each(n,(function(n,i){N.each(i,(function(i,a){var r={pid:n,name:a[s.keyName],value:a[s.keyVal]};V[e][r.value]=N.extend(a,r),t.push(r);var o=a[s.keyChildren];o&&o.length&&(l[r.value]=o)}))}))};do{c()}while(Object.getOwnPropertyNames(l).length);var d=N("."+t+' dl[xid="'+e+'"]').parents("."+x),f=['<div class="xm-select-linkage">'];N.each(r,(function(e,t){var n=['<div style="left: '+(a-0)*e+'px;" class="xm-select-linkage-group xm-select-linkage-group'+(e+1)+" "+(0!=e?"xm-select-linkage-hide":"")+'">'];N.each(t,(function(e,t){var i='<li title="'+t.name+'" pid="'+t.pid+'" xm-value="'+t.value+'"><span>'+t.name+"</span></li>";n.push(i)})),n.push("</div>"),f=f.concat(n)})),f.push('<div style="clear: both; height: 288px;"></div>'),f.push("</div>"),d.find("dl").html(f.join("")),d.find("."+n).css("display","none")},P.prototype.renderReplace=function(e,n){var i=this,a=N("."+t+' dl[xid="'+e+'"]'),r=_[e]?_[e]:E;n=this.exchangeData(e,n),V[e]=n;var o=n.map((function(t){var n=N.extend({},t,{innerHTML:t[r.keyName],value:t[r.keyVal],sel:t[r.keySel],disabled:t[r.keyDis],type:t.type,name:t[r.keyName]});return i.createDD(e,n)})).join("");a.find("dd:not(.xm-select-tips),dt:not([style])").remove(),a.find("dt[style]").after(N(o))},P.prototype.exchangeData=function(e,t){var n=_[e]?_[e]:E,i=n.keyChildren,a=n.keyDis;return V[e]={},this.getChildrenList(t,i,a,[],!1)},P.prototype.getChildrenList=function(e,t,n,i,a){for(var r=[],o=0,l=0;l<e.length;l++){var s=e[l];if(s.type&&"optgroup"==s.type)r.push(s);else{o++;var c=i.concat([]);c.push(o-1+"_E"),s.XM_PID_VALUE=JSON.stringify(c),s[n]=s[n]||a,r.push(s);var d=s[t];if(d&&M.isArray(d)&&d.length){s.XM_TREE_FOLDER=!0;var f=c.concat([]),u=this.getChildrenList(d,t,n,f,s[n]);r=r.concat(u)}}}return r},P.prototype.create=function(e,t,n){if(t&&n){var i=A[e],a=N('[xid="'+e+'"]'),r=a.find("dd.xm-select-tips.xm-dl-input"),o=null,l=a.find("dd."+f);if(a.find("dd:not(.xm-select-tips):not(."+f+")").each((function(e,t){n==N(t).find("span").attr("name")&&(o=t)})),!o){var s=i.config.create(e,n);l[0]?(l.attr("lay-value",s),l.find("span").text(n),l.find("span").attr("name",n),l.removeClass(v)):r.after(N(this.createDD(e,{name:n,innerHTML:n,value:s},f+" xm-select-create-long")))}}else N("[xid="+e+"] dd."+f).remove()},P.prototype.createDD=function(e,t,n){var i,a=_[e]?_[e]:E,r=N.trim(t.innerHTML);V[e][t.value]=N(t).is("option")?((i={})[a.keyName]=r,i[a.keyVal]=t.value,i[a.keyDis]=t.disabled,t=i):t;var o=A[e].config.template(e,t),l=t.XM_PID_VALUE,s=-1==(l=l?JSON.parse(l):[-1])[0]?"":'tree-id="'+l.join("-")+'" tree-folder="'+!!t.XM_TREE_FOLDER+'"';return'<dd lay-value="'+t.value+'" class="'+(t.disabled?c:"")+" "+(n||"")+'" '+s+'>\n\t\t\t\t\t<div class="xm-unselect xm-form-checkbox '+(t.disabled?c:"")+'"  style="margin-left: '+30*(l.length-1)+'px">\n\t\t\t\t\t\t<i class="xm-iconfont"></i>\n\t\t\t\t\t\t<span name="'+r+'">'+o+"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</dd>"},P.prototype.createQuickBtn=function(e,t){return'<div class="xm-cz" method="'+e.name+'" title="'+e.name+'" '+(t?'style="margin-right: '+t+'"':"")+'><i class="'+e.icon+'"></i><span>'+e.name+"</span></div>"},P.prototype.renderBtns=function(e,t,n){var i=this,a=[],r=N('dl[xid="'+e+'"]');return a.push('<div class="xm-cz-group" show="'+t+'" style="max-width: '+(r.prev().width()-54)+'px;">'),N.each(A[e].config.btns,(function(e,t){a.push(i.createQuickBtn(t,n))})),a.push("</div>"),a.push(this.createQuickBtn({icon:"xm-iconfont icon-caidan",name:""})),a.join("")},P.prototype.renderSelect=function(e,t,i){var a=this;V[e]={};var r=[];return A[e].config.btns.length?(setTimeout((function(){var t=N('dl[xid="'+e+'"]');t.parents("."+x).attr(l,A[e].config.searchType),t.find("."+T).css("max-width",t.prev().width()-54+"px")}),10),r.push(['<dd lay-value="" class="xm-select-tips" style="background-color: #FFF!important;">',this.renderBtns(e,null,"30px"),"</dd>",'<dd lay-value="" class="xm-select-tips xm-dl-input" style="background-color: #FFF!important;">','<i class="xm-iconfont icon-sousuo"></i>','<input type="text" class="xm-input '+n+'" placeholder="请搜索"/>',"</dd>"].join(""))):r.push('<dd lay-value="" class="xm-select-tips">'+t+"</dd>"),this.isArray(i)?N(i).each((function(t,n){n&&(n.type&&"optgroup"===n.type?r.push("<dt>"+n.name+"</dt>"):r.push(a.createDD(e,n)))})):N(i).find("*").each((function(t,n){("option"!=n.tagName.toLowerCase()||0!=t||n.value)&&("optgroup"===n.tagName.toLowerCase()?r.push("<dt>"+n.label+"</dt>"):r.push(a.createDD(e,n)))})),r.push('<dt style="display:none;"> </dt>'),r.push('<dd class="xm-select-tips '+b+" "+(2===r.length?C:"")+'">没有选项</dd>'),r.join("")},P.prototype.on=function(){var e=this;this.one(),N(document).on("click",(function(n){N(n.target).parents("."+g)[0]||(N("."+t+" dl ."+v).removeClass(v),N("."+t+" dl dd."+C).removeClass(C),N("."+t+" dl dd."+f).remove(),N.each(A,(function(t,n){e.clearInput(t),n.values.length||e.changePlaceHolder(N('div[FS_ID="'+t+'"] .'+r))}))),N("."+t+" ."+k).each((function(t,n){e.changeShow(N(n).find("."+g),!1)}))}))},P.prototype.calcLabelLeft=function(e,t,n){var i=this.getPosition(e[0]);i.y=i.x+e[0].clientWidth;var a=e[0].offsetLeft;if(e.find("span").length)if(n){var r=e.find("span:last");r="none"==r.css("display")?r.prev()[0]:r[0];var o=this.getPosition(r);o.y=o.x+r.clientWidth,a=o.y>i.y?a-(o.y-i.y)-5:0}else if(t<0){var l=e.find(":last");l="none"==l.css("display")?l.prev()[0]:l[0];var s=this.getPosition(l);s.y=s.x+l.clientWidth,s.y>i.y&&(a-=10)}else a<0&&(a+=10),a>0&&(a=0);else a=0;e.css("left",a+"px")},P.prototype.one=function(t){var i=this;N(t||document).off("click","."+g).on("click","."+g,(function(t){var a=N(t.target),r=a.is(g)?a:a.parents("."+g),o=r.next(),l=o.attr("xid");if(N("dl[xid]").not(o).each((function(e,t){i.clearInput(N(t).attr("xid"))})),N("dl[xid]").not(o).find("dd."+v).removeClass(v),r.hasClass(d))return!1;if(a.is("."+y)||a.is("."+n+"[readonly]"))return i.changeShow(r,!r.parents("."+x).hasClass(k)),!1;if(r.find("."+n+":not(readonly)")[0]){var s=r.find("."+n),f={x:t.pageX,y:t.pageY},u=i.getPosition(r[0]);for(r.width();f.x>u.x;){if(N(document.elementFromPoint(f.x,f.y)).is(s))return s.focus(),i.changeShow(r,!0),!1;f.x-=50}}if(a.is("."+n))return i.changeShow(r,!0),!1;if(a.is('i[fsw="'+e+'"]')){var p=i.getItem(l,a),h=o.find("dd[lay-value='"+p.value+"']");return h.hasClass(c)||i.handlerLabel(l,h,!1,p),!1}return i.changeShow(r,!r.parents("."+x).hasClass(k)),!1})),N(t||document).off("click","dl."+h).on("click","dl."+h,(function(e){var t=N(e.target);if(t.is("."+p)||t.parents("."+p)[0]){var n=(t=t.is("li")?t:t.parents("li[xm-value]")).parents(".xm-select-linkage-group"),r=t.parents("dl").attr("xid");if(!r)return!1;n.find(".xm-select-active").removeClass("xm-select-active"),t.addClass("xm-select-active"),n.nextAll(".xm-select-linkage-group").addClass("xm-select-linkage-hide");var o=n.next(".xm-select-linkage-group");if(o.find("li").addClass("xm-select-linkage-hide"),o.find('li[pid="'+t.attr("xm-value")+'"]').removeClass("xm-select-linkage-hide"),o[0]&&0!=o.find("li:not(.xm-select-linkage-hide)").length)o.removeClass("xm-select-linkage-hide");else{var l=[],s=0,d=!t.hasClass("xm-select-this");A[r].config.radio&&t.parents(".xm-select-linkage").find(".xm-select-this").removeClass("xm-select-this");do{l[s++]={name:t.find("span").text(),value:t.attr("xm-value")},t=t.parents(".xm-select-linkage-group").prev().find('li[xm-value="'+t.attr("pid")+'"]')}while(t.length);l.reverse();var f={name:l.map((function(e){return e.name})).join("/"),value:l.map((function(e){return e.value})).join("/")};i.handlerLabel(r,null,d,f)}return!1}if(t.is("dl"))return!1;if(t.is("dt"))return t.nextUntil("dt").each((function(e,t){(t=N(t)).hasClass(c)||t.hasClass(a)||t.find("i:not(.icon-expand)").click()})),!1;var u=t.is("dd")?t:t.parents("dd"),h=u.parent("dl").attr("xid");if(u.hasClass(c))return!1;if(t.is("i.icon-caidan")){var v=[],m=[];return t.parents("dl").find('dd[tree-folder="true"]').each((function(e,t){null==N(t).attr("xm-tree-hidn")?v.push(t):m.push(t)})),(m.length?m:v).forEach((function(e){return e.click()})),!1}var y=u.attr("tree-id");if(y){if(t.is("i:not(.icon-expand)"))return i.handlerLabel(h,u,!u.hasClass(a)),!1;var g=_[h]||E,x=g.tree,k=u.nextAll('dd[tree-id^="'+y+'"]');if(k&&k.length){var b=k[0].clientHeight;return b?(i.addTreeHeight(u,b),b=0):(b=u.attr("xm-tree-hidn")||36,u.removeAttr("xm-tree-hidn"),u.find(">i").remove(),k=k.filter((function(e,t){return N(t).attr("tree-id").split("-").length-1==y.split("-").length}))),k.animate({height:b},150),!1}if(x.nextClick&&x.nextClick instanceof Function)return x.nextClick(h,i.getItem(h,u),(function(e){if(e&&e.length){u.attr("tree-folder","true");var t=[];e.forEach((function(e,n){e.innerHTML=e[g.keyName],e.XM_PID_VALUE=JSON.stringify(y.split("-").concat([n])),t.push(i.createDD(h,e)),V[h][e[g.keyVal]]=e})),u.after(t.join(""))}else i.handlerLabel(h,u,!u.hasClass(a))})),!1}if(u.hasClass(w)){var C=t.is("."+S)?t:t.parents("."+S);if(!C[0])return!1;var T=C.attr("method"),L=A[h].config.btns.filter((function(e){return e.name==T}))[0];return L&&L.click&&L.click instanceof Function&&L.click(h,i),!1}return i.handlerLabel(h,u,!u.hasClass(a)),!1}))},P.prototype.addTreeHeight=function(e,t){var n=this,i=e.attr("tree-id"),a=e.nextAll('dd[tree-id^="'+i+'"]');a.length&&(e.append('<i class="xm-iconfont icon-expand"></i>'),e.attr("xm-tree-hidn",t),a.each((function(e,i){var a=N(i);n.addTreeHeight(a,t)})))};var V={};P.prototype.getItem=function(t,n){if(n instanceof N){if(n.is('i[fsw="'+e+'"]')){var i=n.parent();return V[t][n]||{name:i.find("font").text(),value:i.attr("value")}}var a=n.attr("lay-value");return V[t][a]?V[t][a]:V[t][a]={name:n.find("span[name]").attr("name"),value:a}}return"string"==typeof n&&-1!=n.indexOf("/")?V[t][n]||{name:this.valToName(t,n),value:n}:V[t][n]},P.prototype.linkageAdd=function(e,t){var n=N('dl[xid="'+e+'"]');n.find(".xm-select-active").removeClass("xm-select-active");var i=t.value.split("/"),a=void 0,r=void 0,o=0,l=[];do{a=i[o],(r=n.find(".xm-select-linkage-group"+(o+1)+' li[xm-value="'+a+'"]'))[0]&&l.push(r),o++}while(r.length&&null!=a);l.length==i.length&&N.each(l,(function(e,t){t.addClass("xm-select-this")}))},P.prototype.linkageDel=function(e,t){var n=N('dl[xid="'+e+'"]'),i=t.value.split("/"),a=void 0,r=void 0,o=i.length-1;do{a=i[o],(r=n.find(".xm-select-linkage-group"+(o+1)+' li[xm-value="'+a+'"]')).parent().next().find("li[pid="+a+"].xm-select-this").length||r.removeClass("xm-select-this"),o--}while(r.length&&null!=a)},P.prototype.valToName=function(e,t){var n=N('dl[xid="'+e+'"]'),i=(t+"").split("/");if(!i.length)return null;var a=[];return N.each(i,(function(e,t){var i=n.find(".xm-select-linkage-group"+(e+1)+' li[xm-value="'+t+'"] span').text();a.push(i)})),a.length==i.length?a.join("/"):null},P.prototype.commonHandler=function(t,n){n&&n[0]&&(this.checkHideSpan(t,n),this.changePlaceHolder(n),this.retop(n.parents("."+x)),this.calcLabelLeft(n,0,!0),this.setHidnVal(t,n),n.parents("."+g+" ."+e).attr("title",A[t].values.map((function(e){return e.name})).join(",")))},P.prototype.initVal=function(e){var t=this,n={};e?n[e]=A[e]:n=A,N.each(n,(function(e,n){var i=n.values,o=N('dl[xid="'+e+'"]').parent(),l=o.find("."+r),s=o.find("dl");s.find("dd."+a).removeClass(a);var c=i.concat([]);c.concat([]).forEach((function(n,i){t.addLabel(e,l,n),s.find('dd[lay-value="'+n.value+'"]').addClass(a)})),n.config.radio&&c.length&&i.push(c[c.length-1]),t.commonHandler(e,l)}))},P.prototype.setHidnVal=function(e,n){n&&n[0]&&n.parents("."+t).find("."+m).val(A[e].values.map((function(e){return e.value})).join(","))},P.prototype.handlerLabel=function(e,t,n,i,o){var l=N('[xid="'+e+'"]').prev().find("."+r),s=t&&this.getItem(e,t),d=A[e].values,u=A[e].config.on||j.on[e],p=A[e].config.endOn||j.endOn[e];i&&(s=i);var h=A[e];if(n&&h.config.max&&h.values.length>=h.config.max){var v=j.maxTips[e]||A[e].config.maxTips;v&&v(e,d.concat([]),s,h.config.max)}else if(!(!o&&u&&u instanceof Function&&0==u(e,d.concat([]),s,n,t&&t.hasClass(c)))){var m=N('dl[xid="'+e+'"]');n?(t&&t[0]?(t.addClass(a),t.removeClass(f)):m.find(".xm-select-linkage")[0]&&this.linkageAdd(e,s),this.addLabel(e,l,s),d.push(s)):(t&&t[0]?t.removeClass(a):m.find(".xm-select-linkage")[0]&&this.linkageDel(e,s),this.delLabel(e,l,s),this.remove(d,s)),l[0]&&(h.config.radio&&this.changeShow(l,!1),l.parents("."+g).prev().removeClass("layui-form-danger"),h.config.clearInput&&this.clearInput(e),this.commonHandler(e,l),!o&&p&&p instanceof Function&&p(e,d.concat([]),s,n,t&&t.hasClass(c)))}},P.prototype.addLabel=function(t,n,i){if(i){var r='fsw="'+e+'"',o=[N("<span "+r+' value="'+i.value+'"><font '+r+">"+i.name+"</font></span>"),N("<i "+r+' class="xm-iconfont icon-close"></i>')],l=o[0],s=o[1];l.append(s);var c=A[t];c.config.radio&&(c.values.length=0,N('dl[xid="'+t+'"]').find("dd."+a+':not([lay-value="'+i.value+'"])').removeClass(a),n.find("span").remove()),n.find("input").css("width","50px"),n.find("input").before(l)}},P.prototype.delLabel=function(e,t,n){n&&t.find('span[value="'+n.value+'"]:first').remove()},P.prototype.checkHideSpan=function(t,n){n.parents("."+e)[0].offsetHeight;n.find("span.xm-span-hide").removeClass("xm-span-hide"),n.find("span[style]").remove();var i=A[t].config.showCount;n.find("span").each((function(e,t){e>=i&&N(t).addClass("xm-span-hide")}));var a=n.find("span:eq("+i+")");a[0]&&a.before(N('<span style="padding-right: 6px;" fsw="'+e+'"> + '+(n.find("span").length-i)+"</span>"))},P.prototype.retop=function(t){var n=t.find("dl"),i=t.offset().top+t.outerHeight()+5-H.scrollTop(),a=n.outerHeight(),r=t.hasClass("layui-form-selectup")||-1!=n.css("top").indexOf("-")||i+a>H.height()&&i>=a;t=t.find("."+e);var o=A[n.attr("xid")],l=n.parents(".layui-form-pane")[0]&&n.prev()[0].clientHeight>38?14:10;(o&&"up"==o.config.direction||r)&&(r=!0,o&&"down"==o.config.direction&&(r=!1));var s=t[0].offsetTop+t.height()+l;r?n.css({top:"auto",bottom:s+3+"px"}):n.css({top:s+"px",bottom:"auto"})},P.prototype.changeShow=function(e,i){N(".layui-form-selected").removeClass("layui-form-selected");var a=e.parents("."+x),o=a.hasClass(k),l=a.find("dl").attr("xid");if(N("."+t+" ."+x).not(a).removeClass(k),i?(this.retop(a),a.addClass(k),a.find("."+n).focus(),a.find("dl dd[lay-value]:not(.xm-select-tips)").length||a.find("dl ."+b).addClass(C)):(a.removeClass(k),this.clearInput(l),a.find("dl ."+C).removeClass(C),a.find("dl dd."+v).removeClass(v),a.find("dl dd."+f).remove(),l&&A[l]&&A[l].config.isEmpty&&this.triggerSearch(a),this.changePlaceHolder(a.find("."+r))),i!=o){var s=A[l].config.opened||j.opened[l];i&&s&&s instanceof Function&&s(l);var c=A[l].config.closed||j.closed[l];!i&&c&&c instanceof Function&&c(l)}},P.prototype.changePlaceHolder=function(a){var r=a.parents("."+g);if(r[0]||(r=a.parents("dl").prev()),r[0]){var o=a.parents("."+t).find("dl[xid]").attr("xid");if(A[o]&&A[o].config.height);else{var l=r.find("."+e)[0].clientHeight;r.css("height",(l>36?l+4:l)+"px");var s=r.parents("."+t).parent().prev();s.is(".layui-form-label")&&r.parents(".layui-form-pane")[0]&&(l=l>36?l+4:l,r.css("height",l+"px"),s.css({height:l+2+"px",lineHeight:l-18+"px"}))}var c=r.find("."+i+" input");if(!a.find("span:last")[0]&&!r.find("."+n).val()){var d=c.attr("back");c.removeAttr("back"),c.attr("placeholder",d)}else{var f=c.attr("placeholder");c.removeAttr("placeholder"),c.attr("back",f)}}},P.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(e[n].value==t||e[n].value==(t?t.value:t)||e[n]==t||JSON.stringify(e[n])==JSON.stringify(t))return n;return-1},P.prototype.remove=function(e,t){var n=this.indexOf(e,t?t.value:t);return n>-1&&(e.splice(n,1),!0)},P.prototype.selectAll=function(e,t,n){var i=this,r=N('[xid="'+e+'"]');r[0]&&(r.find(".xm-select-linkage")[0]||r.find("dd[lay-value]:not(.xm-select-tips):not(."+a+")"+(n?":not(."+c+")":"")).each((function(n,a){a=N(a);var o=i.getItem(e,a);i.handlerLabel(e,r.find('dd[lay-value="'+o.value+'"]'),!0,o,!t)})))},P.prototype.removeAll=function(e,t,n){var i=this,a=N('[xid="'+e+'"]');a[0]&&(a.find(".xm-select-linkage")[0]?A[e].values.concat([]).forEach((function(e,t){var n=e.value.split("/"),i=void 0,r=void 0,o=0;do{i=n[o++],(r=a.find(".xm-select-linkage-group"+o+':not(.xm-select-linkage-hide) li[xm-value="'+i+'"]')).click()}while(r.length&&null!=i)})):A[e].values.concat([]).forEach((function(r,o){n&&a.find('dd[lay-value="'+r.value+'"]').hasClass(c)||i.handlerLabel(e,a.find('dd[lay-value="'+r.value+'"]'),!1,r,!t)})))},P.prototype.reverse=function(e,t,n){var i=this,r=N('[xid="'+e+'"]');r[0]&&(r.find(".xm-select-linkage")[0]||r.find("dd[lay-value]:not(.xm-select-tips)"+(n?":not(."+c+")":"")).each((function(n,o){o=N(o);var l=i.getItem(e,o);i.handlerLabel(e,r.find('dd[lay-value="'+l.value+'"]'),!o.hasClass(a),l,!t)})))},P.prototype.skin=function(e){var n=["default","primary","normal","warm","danger"],i=n[Math.floor(Math.random()*n.length)];N('dl[xid="'+e+'"]').parents("."+t).find("."+x).attr("xm-select-skin",i),this.check(e)&&this.commonHandler(e,N('dl[xid="'+e+'"]').parents("."+t).find("."+r))},P.prototype.getPosition=function(e){for(var t=0,n=0;null!=e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{x:t,y:n}},P.prototype.onreset=function(){N(document).on("click","[type=reset]",(function(e){N(e.target).parents("form").find("."+t+" dl[xid]").each((function(e,t){var n=t.getAttribute("xid"),i=N(t),a=void 0,r={};M.removeAll(n),A[n].config.init.forEach((function(e,t){e&&(!r[e]||A[n].config.repeat)&&(a=i.find('dd[lay-value="'+e.value+'"]'))[0]&&(M.handlerLabel(n,a,!0),r[e]=1)}))}))}))},P.prototype.bindEvent=function(e,t,n){t&&t instanceof Function&&(n=t,t=null),n&&n instanceof Function&&(t?A[t]?(A[t].config[e]=n,delete j[e][t]):j[e][t]=n:N.each(A,(function(t,i){A[t]?A[t].config[e]=n:j[e][t]=n})))},P.prototype.check=function(e,t){return!!N('dl[xid="'+e+'"]').length||(N('select[xm-select="'+e+'"]').length?t?void 0:(this.render(e,N('select[xm-select="'+e+'"]')),!0):(delete A[e],!1))},P.prototype.render=function(e,n){M.init(n),M.one(N('dl[xid="'+e+'"]').parents("."+t)),M.initVal(e)},P.prototype.log=function(e){console.log(e)};var U=function(){this.v="4.0.0.0910",this.render()},M=new P;return U.prototype.value=function(e,t,n){if("string"!=typeof e)return[];var i=A[e];if(!M.check(e))return[];if("string"==typeof t||null==t){var a=i.values.concat([])||[];return"val"==t?a.map((function(e){return e.value})):"valStr"==t?a.map((function(e){return e.value})).join(","):"name"==t?a.map((function(e){return e.name})):"nameStr"==t?a.map((function(e){return e.name})).join(","):a}if(M.isArray(t)){var r=N('[xid="'+e+'"]'),o={},l=void 0,s=!0;0==n?s=!1:1==n?s=!0:M.removeAll(e),s&&i.values.forEach((function(e,t){o[e.value]=1})),t.forEach((function(t,n){!t||o[t]&&!i.config.repeat||((l=r.find('dd[lay-value="'+t+'"]'))[0]?(M.handlerLabel(e,l,s,null,!0),o[t]=1):M.valToName(e,t)&&(M.handlerLabel(e,l,s,M.getItem(e,t),!0),o[t]=1))}))}},U.prototype.on=function(e,t,n){return M.bindEvent(n?"endOn":"on",e,t),this},U.prototype.filter=function(e,t){return M.bindEvent("filter",e,t),this},U.prototype.maxTips=function(e,t){return M.bindEvent("maxTips",e,t),this},U.prototype.opened=function(e,t){return M.bindEvent("opened",e,t),this},U.prototype.closed=function(e,t){return M.bindEvent("closed",e,t),this},U.prototype.config=function(e,n,i){return e&&"object"==(void 0===e?"undefined":_typeof(e))&&(i=1==n,n=e,e=null),n&&"object"==(void 0===n?"undefined":_typeof(n))&&(i&&(n.header||(n.header={}),n.header["Content-Type"]="application/json; charset=UTF-8",n.dataType="json"),e?(_[e]=N.extend(!0,{},_[e]||E,n),!M.check(e)&&this.render(e),A[e]&&n.direction&&(A[e].config.direction=n.direction),A[e]&&n.clearInput&&(A[e].config.clearInput=!0),n.searchUrl&&A[e]&&M.triggerSearch(N("."+t+' dl[xid="'+e+'"]').parents("."+x),!0)):(N.extend(!0,E,n),N.each(_,(function(e,t){N.extend(!0,t,n)})))),this},U.prototype.render=function(n,i){var a;n&&"object"==(void 0===n?"undefined":_typeof(n))&&(i=n,n=null);var o=i?(_defineProperty(a={init:i.init,disabled:i.disabled,max:i.max,isSearch:i.isSearch,searchUrl:i.searchUrl,isCreate:i.isCreate,radio:i.radio,skin:i.skin,direction:i.direction,height:i.height,formname:i.formname,layverify:i.layverify,layverType:i.layverType,showCount:i.showCount,placeholder:i.placeholder,create:i.create,filter:i.filter,maxTips:i.maxTips,on:i.on},"on",i.on),_defineProperty(a,"opened",i.opened),_defineProperty(a,"closed",i.closed),_defineProperty(a,"template",i.template),_defineProperty(a,"clearInput",i.clearInput),a):{};return i&&null!=i.searchType&&(o.searchType="dl"==i.searchType?1:0),n?(O[n]={},N.extend(O[n],A[n]?A[n].config:{},o)):N.extend(F,o),(N("select["+e+'="'+n+'"]')[0]?N("select["+e+'="'+n+'"]'):N("select["+e+"]")).each((function(n,i){var a=i.getAttribute(e);M.render(a,i),setTimeout((function(){return M.setHidnVal(a,N('select[xm-select="'+a+'"] + div.'+t+" ."+r))}),10)})),this},U.prototype.disabled=function(e){var t={};return e?M.check(e)&&(t[e]=A[e]):t=A,N.each(t,(function(e,t){N('dl[xid="'+e+'"]').prev().addClass(d)})),this},U.prototype.undisabled=function(e){var t={};return e?M.check(e)&&(t[e]=A[e]):t=A,N.each(t,(function(e,t){N('dl[xid="'+e+'"]').prev().removeClass(d)})),this},U.prototype.data=function(e,t,n){return e&&t&&n?M.check(e)?(this.value(e,[]),this.config(e,n),"local"==t?M.renderData(e,n.arr,1==n.linkage,n.linkageWidth?n.linkageWidth:"100"):"server"==t&&M.ajax(e,n.url,n.keyword,1==n.linkage,n.linkageWidth?n.linkageWidth:"100"),this):(M.log("id: "+e+" not render !!!"),this):(M.log("id: "+e+" param error !!!"),this)},U.prototype.btns=function(e,t,n){if(e&&M.isArray(e)&&(t=e,e=null),!t||!M.isArray(t))return this;var a={};return e?M.check(e)&&(a[e]=A[e]):a=A,t=t.map((function(e){if("string"==typeof e){if("select"==e)return D[0];if("remove"==e)return D[1];if("reverse"==e)return D[2];if("skin"==e)return D[3]}return e})),N.each(a,(function(e,a){a.config.btns=t;var r=N('dl[xid="'+e+'"]').find(".xm-select-tips:first");if(t.length){var o=n&&n.show&&("name"==n.show||"icon"==n.show)?n.show:"",l=M.renderBtns(e,o,n&&n.space?n.space:"30px");r.html(l)}else{var s=r.parents("."+x).find("."+i+" input"),c=s.attr("placeholder")||s.attr("back");r.html(c),r.removeAttr("style")}})),this},U.prototype.search=function(e,t){return e&&M.check(e)&&(_[e]=N.extend(!0,{},_[e]||E,{first:!0,searchVal:t}),M.triggerSearch(N('dl[xid="'+e+'"]').parents("."+x),!0)),this},U.prototype.replace=function(e,t,n){var i=this;if(!e||!t||!n)return M.log("id: "+e+" param error !!!"),this;if(!M.check(e,!0))return M.log("id: "+e+" not render !!!"),this;var a=this.value(e,"val");this.value(e,[]),this.config(e,n),"local"==t?(M.renderData(e,n.arr,1==n.linkage,n.linkageWidth?n.linkageWidth:"100",!1,!0),this.value(e,a,!0)):"server"==t&&M.ajax(e,n.url,n.keyword,1==n.linkage,n.linkageWidth?n.linkageWidth:"100",!1,(function(e){i.value(e,a,!0)}),!0)},new U}));